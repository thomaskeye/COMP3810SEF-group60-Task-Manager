<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <title>Smart Task Manager - Change Password</title>
    <link rel="stylesheet" href="/css/styles.css" />
  </head>
  <body>
    <div class="container">
      <header class="header">
        <div>
          <h1>Change Password</h1>
          <p>Welcome, <strong><%= currentUser && currentUser.username %></strong></p>
        </div>
        <div style="display: flex; gap: 0.5rem;">
          <a href="/dashboard" class="btn secondary" style="text-decoration: none; display: inline-block;">Back to Dashboard</a>
          <form method="POST" action="/logout" style="display: inline;">
            <button type="submit" class="btn secondary">Logout</button>
          </form>
        </div>
      </header>

      <% if (typeof error !== 'undefined' && error) { %>
      <div class="alert error"><%= error %></div>
      <% } %>

      <% if (typeof success !== 'undefined' && success) { %>
      <div class="alert success" style="background-color: #d4edda; color: #155724; border: 1px solid #c3e6cb; padding: 1rem; border-radius: 4px; margin-bottom: 1rem;">
        <%= success %>
      </div>
      <% } %>

      <section class="card">
        <h2>Change Your Password</h2>
        <form method="POST" action="/change-password" class="task-form">
          <div>
            <label for="username">Username</label>
            <input
              type="text"
              id="username"
              name="username"
              required
              minlength="3"
              maxlength="30"
              pattern="[a-zA-Z0-9_]+"
              placeholder="Enter your username"
              value="<%= currentUser && currentUser.username %>"
            />
          </div>

          <div>
            <label for="oldPassword">Old Password</label>
            <input
              type="password"
              id="oldPassword"
              name="oldPassword"
              required
              placeholder="Enter your current password"
            />
          </div>

          <div>
            <label for="newPassword">New Password</label>
            <input
              type="password"
              id="newPassword"
              name="newPassword"
              required
              placeholder="Enter your new password"
            />
          </div>

          <button type="submit" class="btn primary">Change Password</button>
        </form>
      </section>
    </div>
  </body>
</html>
